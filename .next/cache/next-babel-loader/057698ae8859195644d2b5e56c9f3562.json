{"ast":null,"code":"/*\n|--------------------------------------------------------------------------\n| User validation.\n|--------------------------------------------------------------------------\n|\n| Validate the input of a user upon her login or registration.\n|\n*/\nimport validator from \"validator\";\nexport class UserValidator {\n  /**\n   *\n   * @param {string} name\n   *   The name of the new user.\n   * @param {string} email\n   *   The email of the new user.\n   * @param {string} password\n   *   The password of the new user.\n   * @param {string} passwordConfirmed\n   *   The password confirmation.\n   * @param {number} minPassChars\n   *   The minimum number of characters the password must have.\n   *\n   * @return {boolean}\n   *   True if validation was successful.\n   */\n  validateRegistrationInput(name, email, password, passwordConfirmed, minPassChars) {\n    let errorDetected = false;\n    const errors = {\n      name: \"\",\n      password: \"\",\n      email: \"\"\n    }; // Check name.\n\n    const isNameValid = this.validateName(name);\n\n    if (!isNameValid) {\n      errors.name = \"The name may only contain letters.\";\n      errorDetected = true;\n    } // Check password.\n\n\n    const isPasswordValid = this.validatePassword(password, passwordConfirmed, minPassChars);\n\n    if (!isPasswordValid) {\n      errors.password = \"The password must be at least 8 characters long.\";\n      errorDetected = true;\n    } // Check email.\n\n\n    const isEmailValid = this.validateEmail(email);\n\n    if (!isEmailValid) {\n      errors.email = \"Please provide a valid email address.\";\n      errorDetected = true;\n    } // Return true if everythin is valid.\n\n\n    if (!errorDetected) {\n      return true;\n    }\n\n    return errors;\n  }\n  /**\n   * Check if the name of the user only contains letters.\n   *\n   * @param {string} name\n   *   The name of the user.\n   */\n\n\n  validateName(name) {\n    // Removes spaces as validator does not count them as letters.\n    const tmp = name.replace(\" \", \"\");\n    return validator.isAlpha(tmp);\n  }\n  /**\n   * Confirm the users password when registering.\n   *\n   * @param {string} password\n   *   The password.\n   * @param {string} passwordConfirmed\n   *   The password confirmation.\n   * @param {number} minPasswordLength\n   *   The minimum password length.\n   *\n   * @return {boolean}\n   *   True if validation was successful.\n   */\n\n\n  validatePassword(password, passwordConfirmed, minPasswordLength) {\n    // Check password length:\n    if (password.length < minPasswordLength) {\n      return false;\n    } // Check that password it not too soft:\n\n\n    if (password.includes(\"passwor\") || password.includes(\"123456\")) {\n      return false;\n    } // Passwords must be equal.\n\n\n    if (password !== passwordConfirmed) {\n      return false;\n    } // Return true if everything is fine.\n\n\n    return true;\n  }\n  /**\n   * Check if the user gave a valid email address.\n   *\n   * @param {string} email\n   *   The email that is validated.\n   *\n   * @return {boolean}\n   *   True if email is valid.\n   */\n\n\n  validateEmail(email) {\n    // Let the validator package handle the big lifting.\n    if (!validator.isEmail(email)) {\n      return false;\n    } // List of strings within the mail that are suspicious.\n\n\n    const blacklist = [\"@example\", \"@email\"]; // Check that none of the blacklist strings is in the mail address.\n\n    const noFraudDetected = blacklist.every(item => {\n      return !email.includes(item);\n    });\n\n    if (!noFraudDetected) {\n      return false;\n    }\n\n    return true;\n  }\n\n}","map":{"version":3,"sources":["/var/www/html/nico_global/services/UserValidator.tsx"],"names":["validator","UserValidator","validateRegistrationInput","name","email","password","passwordConfirmed","minPassChars","errorDetected","errors","isNameValid","validateName","isPasswordValid","validatePassword","isEmailValid","validateEmail","tmp","replace","isAlpha","minPasswordLength","length","includes","isEmail","blacklist","noFraudDetected","every","item"],"mappings":"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","sourcesContent":["/*\n|--------------------------------------------------------------------------\n| User validation.\n|--------------------------------------------------------------------------\n|\n| Validate the input of a user upon her login or registration.\n|\n*/\nimport validator from \"validator\";\n\nexport class UserValidator {\n    /**\n     *\n     * @param {string} name\n     *   The name of the new user.\n     * @param {string} email\n     *   The email of the new user.\n     * @param {string} password\n     *   The password of the new user.\n     * @param {string} passwordConfirmed\n     *   The password confirmation.\n     * @param {number} minPassChars\n     *   The minimum number of characters the password must have.\n     *\n     * @return {boolean}\n     *   True if validation was successful.\n     */\n    public validateRegistrationInput(\n        name: string,\n        email: string,\n        password: string,\n        passwordConfirmed: string,\n        minPassChars: number\n    ): { name: string; email: string; password: string } | boolean {\n        let errorDetected = false;\n        const errors = {\n            name: \"\",\n            password: \"\",\n            email: \"\",\n        };\n        // Check name.\n        const isNameValid = this.validateName(name);\n        if (!isNameValid) {\n            errors.name = \"The name may only contain letters.\";\n            errorDetected = true;\n        }\n\n        // Check password.\n        const isPasswordValid = this.validatePassword(\n            password,\n            passwordConfirmed,\n            minPassChars\n        );\n        if (!isPasswordValid) {\n            errors.password =\n                \"The password must be at least 8 characters long.\";\n            errorDetected = true;\n        }\n\n        // Check email.\n        const isEmailValid = this.validateEmail(email);\n        if (!isEmailValid) {\n            errors.email = \"Please provide a valid email address.\";\n            errorDetected = true;\n        }\n\n        // Return true if everythin is valid.\n        if (!errorDetected) {\n            return true;\n        }\n        return errors;\n    }\n\n    /**\n     * Check if the name of the user only contains letters.\n     *\n     * @param {string} name\n     *   The name of the user.\n     */\n    public validateName(name: string): boolean {\n        // Removes spaces as validator does not count them as letters.\n        const tmp = name.replace(\" \", \"\");\n        return validator.isAlpha(tmp);\n    }\n\n    /**\n     * Confirm the users password when registering.\n     *\n     * @param {string} password\n     *   The password.\n     * @param {string} passwordConfirmed\n     *   The password confirmation.\n     * @param {number} minPasswordLength\n     *   The minimum password length.\n     *\n     * @return {boolean}\n     *   True if validation was successful.\n     */\n    public validatePassword(\n        password: string,\n        passwordConfirmed: string,\n        minPasswordLength: number\n    ): boolean {\n        // Check password length:\n        if (password.length < minPasswordLength) {\n            return false;\n        }\n\n        // Check that password it not too soft:\n        if (password.includes(\"passwor\") || password.includes(\"123456\")) {\n            return false;\n        }\n\n        // Passwords must be equal.\n        if (password !== passwordConfirmed) {\n            return false;\n        }\n\n        // Return true if everything is fine.\n        return true;\n    }\n\n    /**\n     * Check if the user gave a valid email address.\n     *\n     * @param {string} email\n     *   The email that is validated.\n     *\n     * @return {boolean}\n     *   True if email is valid.\n     */\n    public validateEmail(email: string): boolean {\n        // Let the validator package handle the big lifting.\n        if (!validator.isEmail(email)) {\n            return false;\n        }\n\n        // List of strings within the mail that are suspicious.\n        const blacklist = [\"@example\", \"@email\"];\n\n        // Check that none of the blacklist strings is in the mail address.\n        const noFraudDetected = blacklist.every((item) => {\n            return !email.includes(item);\n        });\n\n        if (!noFraudDetected) {\n            return false;\n        }\n\n        return true;\n    }\n}\n"]},"metadata":{},"sourceType":"module"}